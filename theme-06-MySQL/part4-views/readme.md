# Library mysql2

## Директория part4-views - разбор запросов и программ  

В данной директории приведены примеры SQL-запросов и программ по работе с представлениями в MySQL через phpMyAdmin.  

Будем использовать MySQL 8, документация [MySQL 8](https://dev.mysql.com/doc/refman/8.0/en/sql-data-manipulation-statements.html)  

## Введение в язык структурированных запросов SQL

Предполагается, что данные распределены по таблицам и могут иметь логические связи между полями таблиц.  

Синтаксис SQL включает несколько категорий команд, основные из них:  

1) DDL – язык определения данных (Data Definition Language) - для декларации структуры таблиц;  
2) DML – язык манипулирования данными (Data Manipulation Language)- для изменения записей в таблицах;  
3) DQL – язык запросов (Data Query Language) - для выборки данных из таблиц;  
4) DCL – язык управления данными (Data Control Language) - для управления доступом к таблицам.  

> Начальный уровень подготовки по реляционным базам данных можно ограничить:  
> Подмножеством команд DQL:  
>     SELECT  
> Подмножеством команд DML:  
>     INSERT, UPDATE, DELETE  
> Подмножеством команд DDL:  
>     CREATE TABLE, ALTER TABLE, DROP TABLE, CREATE INDEX, ALTER INDEX, DROP INDEX  

---  

Так можно создать таблицу:  

```SQL
CREATE TABLE `abiturs` (
    `id` INT NOT NULL AUTO_INCREMENT , 
    `firstName` VARCHAR(20) NOT NULL , 
    `lastName` VARCHAR(20) NOT NULL , 
    `rating` INT NOT NULL , 
    `city` VARCHAR(20) NULL , 
    PRIMARY KEY (`id`)
);
```

Так можно добавить в таблицу несколько записей:  

```SQL
INSERT INTO abiturs (firstName, lastName, rating, city) 
VALUES 
    ('Женя','Мишкин','217','Кунгур'),
    ('Роман','Бортич','224','Лысьва'),
    ('Оксана','Деревянко','182','Оса'),
    ('Анна','Столбова','194','Кунгур'),
    ('Женя','Хомич','205','Кунгур'),
    ('Коля','Круглов','191','Березники'),
    ('Иван','Иванов','192','Кунгур'),
    ('Петя','Петров','191','Кунгур'),
    ('Женя','Сидоров','196','Кунгур'),
    ('Егор','Капустин','196','Кунгур'),
    ('Алиса','Томатова','201','Кунгур'),
    ('Клава','Ежова','214','Лысьва'),
    ('Женя','Микова','222','Пермь'),
    ('Иаков','Мамин','199','Пермь'),
    ('Стёпа','Комов','195','Пермь');
```

Изменить запись:  

```SQL
UPDATE `abiturs` SET `city`=1;
```

Изменить структуру таблицы:  

```SQL
ALTER TABLE `abiturs`
MODIFY `city` int NULL;
```

---

Однако командой CREATE можно создавать не только статичные таблицы, но и виртуальные (динамические) таблицы - их называют представления. Представления содержат SELECT-запрос к одной или нескольким таблицам или другим представлениям - этот SELECT-запрос возвращает (формирует) таблицу из текущих данных. Сама таблица и данные в ней из представления не существуют реально, они формируются только по результатам запроса. Общий вид команды на формирование представления может выглядеть так:  

```SQL
CREATE VIEW view_1 AS
SELECT * FROM table_1
```

Данный запрос создаёт виртуальную таблицу view_1, которая является копией таблицы table_1. Понятное дело, что особого смысла в этом нет, так как никаких новых данных или новых сочетаний данных мы не получили. Представления удобно применять в тех случаях, когда данные в исходных таблицах нормализованы и неудобны для непосредстенного использования или когда некоторая выборка данных из исходных таблиц часто нужна и сам запрос удобно хранить непосредственно в базе данных или когда запросы достаточно сложные и удобно пользоваться вложенными запросами (тогда более элементарные запросы можно хранить в виде представлений и обращаться к ним из сложных запросов), кроме того, когда вы используете какой то язык программирования для обращения к базе данных, то часть наиболее популярных запросов на выборку данных можно хранить в виде представлений в базе данных.


